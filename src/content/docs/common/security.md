---
title: 前端安全
---

## 请解释一下什么是 XSS，有哪些类型，以及如何防御

**XSS（Cross-Site Scripting，跨站脚本攻击）** 是一种常见的 Web 安全漏洞。攻击者通过向网页中注入恶意脚本，当其他用户访问该页面时，这些脚本会在用户的浏览器中执行，从而达到攻击目的。

- **存储型 XSS（Persistent XSS）:** 恶意脚本被存储在服务器数据库中，所有访问该页面的用户都会触发攻击。例如：在留言板中注入 `<script>alert('XSS')</script>`，所有看到留言的用户都会弹出警告框。
- **反射型 XSS（Non-Persistent XSS）:** 恶意脚本通过 URL 参数传递，服务器立即“反射”给用户，不存储。例如：构造链接 `http://example.com/search?query=<script>alert('XSS')</script>`，诱导用户点击。
- **DOM 型 XSS:** 不经过服务器，恶意脚本通过修改页面 DOM（文档对象模型）直接在浏览器中执行。例如：通过 URL 中的片段（如 `#`）触发前端脚本执行，如 `example.com/page#<script>alert(1)</script>`。

常见危害：

- 窃取用户 Cookie，冒充身份
- 篡改网页内容，进行钓鱼攻击
- 记录用户键盘输入，窃取密码
- 传播恶意软件或进行内网探测

防御措施：

1. **输入过滤与验证**
    - 对用户输入进行校验，过滤掉特殊字符（如 `< > " ' /`），例如使用 DOMPurify、xss 等库
    - 尽量使用白名单机制，只允许特定格式的内容
2. **输出编码**
    - 将输出到 HTML、JS、URL 的内容进行编码，防止浏览器误解析为代码
    - 例如：`<` 编码为 `&lt;`，`>` 编码为 `&gt;`
3. **避免使用危险的 API**
    - 使用 `textContent` 替代 `innerHTML`
    - 避免使用 `eval()` 等动态执行代码的函数
4. **设置安全响应头**
    - 使用 `Content-Security-Policy (CSP)` 限制资源加载来源
    - 设置 `X-XSS-Protection: 1; mode=block` 启用浏览器内置防护
5. **使用 HttpOnly Cookie**
    - 防止 JavaScript 访问 Cookie，降低会话劫持风险
6. **定期安全测试**
    - 进行代码审查、自动化扫描或渗透测试，及时发现并修复漏洞

## 什么是 CSRF

**CSRF（Cross-Site Request Forgery，跨站请求伪造）** 是一种 Web 安全漏洞，攻击者诱导已登录用户在不知情的情况下，向目标网站发送非预期的请求。由于浏览器会自动携带目标网站的 Cookie，服务器可能误认为这是用户的合法操作，从而执行攻击者的恶意指令。

常见危害：

- 修改用户资料或密码
- 执行转账、发消息等业务操作
- 删除数据、更改权限
- 以用户身份发送恶意请求

防御措施：

1. **使用 Anti-CSRF Token**
    - 在表单或请求中加入随机生成的 Token，并在服务端验证
    - Token 应具有一次性、不可预测性，且不通过 Cookie 传递
2. **验证 Referer 或 Origin 头**
    - 检查请求来源是否为合法域名，但此方法不完全可靠（Referer 可能为空或被篡改）
3. **SameSite Cookie 属性**
    - 设置 Cookie 的 `SameSite` 属性为 `Strict` 或 `Lax`，限制跨站请求携带 Cookie
    - 例如：`Set-Cookie: sessionId=abc123; SameSite=Strict`
4. **二次确认**
    - 对敏感操作（如转账、删除）要求用户输入密码或进行验证码确认
5. **短期会话与重新认证**
    - 缩短会话有效期，敏感操作前要求重新登录或认证
6. **避免使用 GET 请求执行敏感操作**
    - 使用 POST、PUT 等方法执行状态变更操作，避免通过 URL 参数触发

## 什么是同源策略？

**同源策略（Same-Origin Policy）** 是浏览器的一种核心安全机制，核心目的是 *防止恶意网站通过脚本窃取或篡改其他网站的敏感数据*。它的核心思想是：只有同一“源”（协议+域名+端口）的网页或脚本才能互相访问资源。意义包括：

- 防止跨站脚本攻击（XSS）：如果恶意网站能随意读取其他网站的数据（如 Cookie、LocalStorage），用户的隐私和账户安全将受到威胁。
- 阻止恶意行为：例如，防止恶意脚本在用户不知情的情况下，以用户身份向其他网站（如银行、邮箱）发起请求（如转账、删除邮件等）。

同源策略虽然安全，但也限制了合法的跨域请求。有时，开发者希望安全地允许跨域请求。**CORS（跨源资源共享，Cross-Origin Resource Sharing）** 就是浏览器提供的一种受控的跨域访问方案。

## 跨域问题是什么？有哪些解决方案？

跨域问题是由于浏览器的 **同源策略** 引发的安全限制，当请求的**协议**、**域名**、**端口** 任一与当前页面不同时，浏览器会拦截响应数据。解决这一问题的核心是通过合法手段绕过或放宽这一限制。

解决方案包括：

- **CORS（跨域资源共享）** 是最标准的方案，通过后端设置响应头（如`Access-Control-Allow-Origin`）明确允许特定域的请求，支持所有 HTTP 方法，但需要前后端协作。
- 若前端可控，可通过**代理服务器**（如 Nginx 或开发环境的 Webpack 代理）转发请求，将跨域转化为同源请求。
- 对于老旧系统，**JSONP** 利用`<script>`标签的特性实现跨域，但仅支持 GET 且安全性较低。
- **WebSocket** 协议天然不受同源策略限制，适合实时通信场景。此外，通过 **PostMessage** 结合`iframe`可实现跨页面通信。
- **修改 document.domain** 则适用于主域相同的子域间交互。

实际选择时，优先考虑**CORS**（需后端支持）或**代理服务器**（前端可控场景），遗留系统可尝试 JSONP，需注意安全性及适用场景限制。

## 什么是 CSP

**CSP（Content Security Policy，内容安全策略）** 是一种由浏览器强制执行的安全机制，用于防止跨站脚本攻击（XSS）、数据注入攻击等。它通过指定哪些资源（如脚本、样式、图片等）可以被加载，来减少攻击面。
